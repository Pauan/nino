<!DOCTYPE html>
<html>
  <body>
    <script src="lib/esprima/esprima.js"></script>
    <script src="nino.js"></script>
    <script>
      var a = NINO.unique("a")
        , b = NINO.unique("b")
        , c = NINO.unique("c")

      NINO.minified = false
      NINO.warnings = false

      function compile(x) {
        var scope = Object.create(NINO.builtins)
        try {
          x = NINO.expression(x)
          x = NINO.traverse(x, scope)
          x = NINO.replace(x, scope)
          console.log(NINO.compile(x))
        } catch (e) {
          console.error(e.message)
        }
      }

      function expr(a) {
        a.forEach(function (x) {
          compile(NINO.fromJSON(x))
        })
      }

      function parse(a) {
        a.forEach(function (x) {
          compile(NINO.parse(x))
        })
      }

      var ret = ["function", [",", c],
                  [",", ["+", a, b, c],
                        ["return", ["+", a, b, c]]]]

      expr([
        "foo\\\"\n\t\b\v\f\r",

        ["&&", 1, 2, 3, 4],

        ["===", 1, 2, 3],

        ["===", 1, ["call", 2, 3], 4],

        ["===", ["call", 1, 2], 2, 3],

        ["===", ["call", 1, 2], ["call", 2, 3], 3],

        ["===", ["call", 1, 2], ["call", 2, 3], ["call", 3, 4]],

        ["===", ["call", 1, 2], ["call", 2, 3], ["call", 3, 4], ["call", 4, 5]],

        ["<", 1, 2, 3],

        ["<", ["call", 1, 2], 2, 3],

        ["<", ["call", 1, 2], ["call", 2, 3], 3],

        ["<", ["call", 1, 2], ["call", 2, 3], ["call", 3, 4]],

        ["<", ["call", 1, 2], ["call", 2, 3], ["call", 3, 4], ["call", 4, 5]],

        [",", ["+", 1, 2],
              ["function", [",", a, b],
                [",", ["return", ret]]]],

        [",", ["function", [",", a, b],
                [",", ["return", ret]]]],

        ["+", 1, 2, 3, 4, 5],

        ["+", 1, ["*", 2, 3]],

        ["*", 1, ["+", 2, 3]],

        ["+", ["-", 2, 3], 1],

        ["+", 1, ["-", 2, 3]],

        ["=", a, ["=", b, 1]],

        ["=", ["=", b, 1], a],

        ["+", ["=", a, 1], 2],

        ["typeof", ["function", [","],
                     ["+", ["=", a, 1], 2]]],

        ["+", ["+", 1]],

        ["-", ["-", 1]],

        ["+", ["!", 1]],

        ["+", ["-", 1]],

        ["!", ["!", 1]],

        ["typeof", ["typeof", 1]],

        [","],

        [",", 1],


        ["<", 1, ["if", 2, 3, 4]],

        ["if"],

        ["if", 1],

        ["if", 1, 2],

        ["if", 1, [",", 2, 3]],

        ["if", 1, 2, 3],

        ["if", 1, 2, 3, 4],

        ["if", 1, 2, 3, 4, 5],

        ["if", 1, 2, 3, 4, 5, 6],

        ["if", 1, ["function", [","], 2], ["function", [","], 3]],

        ["if", 1, 2.5, [",", 3, 3.5]],

        ["if", 1, [",", 2, 5, 2.5], 3.5],

        ["if", 1, [",", 2, 5, 2.5], [",", 3, 3.5]],

        ["if", ["+", a, 1], 2, 3],

        ["if", ["=", a, 1], 2, 3],


        [",", ["if", 1, 2, 3], 4],

        [",", ["if", 1, [",", 2, 3], 5], 4],

        [",", ["if", 1, 3, [",", 4, 5]], 4],

        [",", ["if", 1, [",", 2, 3]], 4],

        [",", ["if", 1, [",", 2, 3], [",", 4, 5]], 4],


        ["+", 1, ["if", 1, 2]],

        ["||", 1, ["if", 1, 2]],

        ["+", ["if", 1, 2, 3], 4],

        ["+", 4, ["if", 1, 2, 3]],

        ["function", [","],
          ["if", 1, 2, 3]],

        ["function", [","],
          ["if", ["var", ["=", a, 1]], ["var", ["=", b, 2]], ["var", ["=", c, 3]]]],

        [",", ["var", ["=", a, 1]], ["var", ["=", b, 2]]],


        ["while", 1, 2],

        ["while", 1, ["var", ["=", a, ["break", 1]]]],

        ["while", 1, ["var", ["=", a, 2]]],


        [",", ["function", [","], 1]],

        ["function", [","],
          ["+", 1, ["return", 2]]],

        ["function", [","],
          ["+", ["call", 1, 2], ["call", 2, 3], ["return", 2], ["call", 3, 4]]],

        ["function", [","],
          ["function", [","], 3]],

        ["++", ["++", 1]],

        ["call", ["+", 1, 2], ["+", 2, 3]],

        ["call", ["function", [","], 1], 2],

        ["+", 1, ["var", a]],

        [",", ["var", ["=", a, 1]], 2],

        ["+", 1, ["var", ["=", a, 2]]],

        ["+", 1, ["var", ["=", a, 2], ["=", b, 3]]],

        ["+", 1, ["var", ["=", a, [",", ["var", b], 2, 3]]]],

        [",", ["call", 3, 4], ["debugger"], ["call", 1, 2]],

        [",", ["call", 3, 4], ["throw"], ["call", 1, 2]],

        [",", ["+", 0, ["=", a, 1]], ["=", b, 2], 3, 4, 5],

        ["+", 1, ["var", ["=", a, 2], ["=", b, 3], c]],

        ["function", [","],
          ["=", [",", 1, 2, 3], [",", 4, 5, 6]]],

        ["function", [","],
          ["+", [",", 1, 2, 3], [",", 4, 5, 6]]],

        ["function", [","],
          ["+", [",", 1, 2, 3]]],


        ["var", ["=", c, 5],
                ["=", a, 10],
                ["=", a, ["function", [","], ["return", 3]]],
                ["=", c, 5],
                ["=", b, ["function", [","], ["return", 4]]]],

        ["var", ["=", c, ["call", 5, 10]],
                ["=", a, ["delete", 10]],
                ["=", a, ["function", [","], ["return", 3]]],
                ["=", c, ["+", 5, 20]],
                ["=", b, ["function", [","], ["return", 4]]]],

        ["var", ["=", a, 5],
                ["=", a, 10],
                ["=", a, ["function", [","], ["return", 3]]],
                ["=", b, 5],
                ["=", b, ["function", [","], ["return", 4]]]],

        ["function", [","],
          ["var", ["=", c, 5],
                  ["=", a, 10],
                  ["=", a, ["function", [","], ["return", 3]]],
                  ["=", c, 5],
                  ["=", b, ["function", [","], ["return", 4]]]]],

        ["function", [","],
          [",", a,
                ["var", ["=", a, 10]]]],

        ["var", ["=", a, ["function", [","], ["return", NINO.unique("d")]]]],

        [",", ["var", a],
              ["=", a, ["function", [","], ["return", NINO.unique("d")]]]],

        ["function-var", a, [","], ["return", NINO.unique("d")]],

        ["try", 1, ["catch", a, 2], ["finally", 3]],

        ["try", 1, ["catch", a, [",", 2, 3]], ["finally", [",", 3, 4]]],

        ["function", [","],
          ["try", 1, ["catch", a, 2], ["finally", 3]]],

        ["function", [","],
          ["return", ["try", 1, ["catch", a, 2], ["finally", 3]]]],

        ["while", 1, ["=", a, ["break"]]],

        ["var", ["=", a, [",", 1, 2, 3]]],

        ["var", b, c, ["=", a, [",", b, c, 1, 2, 3]], ["=", c, [",", 4, 5, 6]]],

        ["if", [",", 1, 2, 3], 4, 5],

        [".", a, b],

        [".", [",", a, b], c],

        [".", a, "b"],

        [".", a, "b^test aha"],

        [".", 1, "foo"],

        [".", 1.5, "foo"],

        ["new", ["function", [","], 1], 2, 3, 4],

        ["call", [",", a, b], 1, 2, 3],

        ["new", [",", a, b], 1, 2, 3],

        ["new", a, 1, 2, 3],

        ["new", a, [",", 1, 2], 3],

        ["for"],
        ["for", 1],
        ["for", 1, 2],
        ["for", 1, 2, 3],
        ["for", 1, 2, 3, 4],
        ["for", ["empty"], ["empty"], ["empty"], 4],

        ["for", 1, 2, 3, [",", 4, 5, 6]],

        ["for", ["var", ["=", a, 1], ["=", b, 2]],
                ["<", a, 10],
                ["++", a],
          [",", 4, 5, 6]],

        ["for", [",", ["var", ["=", a, 1]], ["=", b, 2]],
                ["<", a, 10],
                ["++", a],
          [",", 4, 5, 6]],

        [",", ["var", ["=", a, 1]], ["=", b, 2]],

        ["for-in", 1, 2, 3],

        ["for-in", ["var", ["=", a, 1]], 2, 3],

        ["for-in", ["var", a], 2],
        ["for-in", ["var", a], 2, 3],

        ["for-in", ["var", a], [",", 2, 3, 4], 5],

        ["for-in", ["var", a], 2, [",", 3, 4, 5]],

        ["for-in", ["var", a, b], 2, 3],

        ["for-in", [",", ["=", b, 1], ["var", a]], 2, 3],

        ["for-in", [",", ["=", b, 1], a], 2, 3],

        ["array", 1, 2, 3, 4, 5],

        ["array", 1, [",", 2, 3], 4, 5],

        ["+", 3, ["object", ["=", "a", 1], ["=", "b", 2]]],

        ["+", ["object", ["=", "a", 1], ["=", "b", 2]], 3],

        ["object", ["=", "a", 1], ["=", "b", 2]],

        ["object", ["=", "a", 1], ["=", "b", 2]],

        ["object", ["=", "a", ["function", [","], 1]], ["=", "b", 2]],

        ["object", ["=", "a", [",", 1, 2]], ["=", "b", 3]],

        ["object", ["=", "a", ["object", ["=", "b", 2]]], ["=", "c", 3]],

        ["object", ["=", "a^test aha", 1], ["=", "b", 2]],

        ["object", NINO.variable("a"), NINO.variable("b")],

        ["object", NINO.variable("var"), NINO.variable("b")],

        ["object", "var", "b", 1, 5],

        ["+", a, b],

        ["+", NINO.variable("hiya"), NINO.variable("a")],

        ["+", NINO.unique("a"), NINO.unique("b")],

        (function () {
          var a = NINO.unique("a")
          return ["function", [",", a],
                   ["+", a, NINO.variable("a")]]
        })(),

        ["function", [",", NINO.variable("b")],
          ["+", NINO.unique("b"), NINO.variable("b")]],

        ["function", [",", NINO.variable("a")],
          ["return", ["function", [",", NINO.variable("b")],
                       ["+", NINO.variable("a"), NINO.variable("b")]]]],

        ["function", [","],
          [",", ["try", 1,
                  ["catch", NINO.variable("TEST"),
                    ["var", ["=", NINO.variable("yes"), 5]]]],
                ["+", NINO.unique("yes"), NINO.unique("TEST")]]],

        ["function", [","],
          [",", ["try", 1,
                  ["catch", NINO.variable("TEST"),
                    NINO.unique("TEST")]],
                NINO.unique("TEST")]],

        ["+", NINO.unique("b"), 1],

        ["function-var", NINO.variable("foo"), [","],
          ["return", 1]],

        ["+", NINO.unique("foo"), 1],

        NINO.variable("50fooBar-qux"),
        NINO.variable("foo&bar"),
        NINO.variable("foo_bar"),
        NINO.variable("break"),
        NINO.variable("NaN"),
        NINO.variable("arguments"),
        NINO.unique("arguments"),
        NINO.variable("arguments2"),
        NINO.variable("_"),

        [",", NINO.bypass("var YESNOTESTINGHAHAHA = 5"),
              ["+", 5, 20]],

        ["+", 1, ["var", ["=", NINO.variable("a"), 2]]],

        ["function", [","],
          [",", ["return", 1], 2]],

        ["function", [","],
          ["return", ["if", 1, 2, 3]]],

        ["function", [","],
          ["return", ["if", ["return", 1], 2, 3]]],

        ["function", [","],
          ["return", ["if", 1, ["return", 2]]]],

        ["function", [","],
          ["return", ["if", 1, ["return", 2], ["return", 3]]]],

        ["function", [","],
          ["return", ["if", 1, ["try", 2, ["finally", 3]], 4]]],

        ["function", [","],
          ["if", 1, 2]],

        ["function", [","],
          ["if", 1, 2, 3]],

        ["function", [","],
          ["if", 1, ["throw", 2], ["throw", 3]]],

        ["function", [","],
          ["if", 1, ["throw", 2]]],

        ["function", [","],
          ["if", 1, ["try", 2, ["finally", 3]], 4]],

        ["call", ["call", 1, 2], ["try", 3, ["finally", 4]], ["call", 5, 6]],


        ["+", ["call", 1, 2], ["throw", 3]],
        ["+", ["call", 1, 2], ["debugger"]],
        ["+", ["call", 1, 2], ["try", 3, ["finally", 4]], ["throw", 3]],
        ["+", ["call", 1, 2], ["try", 3, ["finally", 4]]],
        ["+", ["call", 1, 2], ["while", 3, 4]],
        ["+", ["call", 1, 2], ["var", ["=", NINO.variable("a"), ["call", 3, 4]]]],

        ["+", ["call", 1, 2], ["var", ["=", NINO.variable("a"), ["function", [","], ["return", 3]]]]],

        ["+", ["call", NINO.variable("a")],
              ["var", ["=", NINO.variable("a"), 3]]],

        ["+", ["+", ["call", NINO.variable("b")], 2],
              ["var", ["=", NINO.variable("a"), ["call", 3, 4]]]],

        ["+", NINO.variable("a"),
              ["var", ["=", NINO.variable("a"), 3]]],

        ["+", ["+", NINO.variable("a"), 2],
              ["var", ["=", NINO.variable("a"), 3]]],

        ["+", NINO.variable("b"),
              ["var", ["=", NINO.variable("a"), 3]]],


        ["=", a, ["=", b, ["=", c, 1]]],
        ["=", a, b, c, 1],

        NINO.lineComment("foobarquxcorge"),
        NINO.blockComment("testing*/\ntesting\ntesting"),
        NINO.docComment("testing*/\ntesting\ntesting"),

        [",", NINO.blockComment("testing*/\ntesting\ntesting"),
              ["call", 1, 2]],

        ["function", [","],
          [",", NINO.blockComment("documentation goes here"),
                NINO.lineComment("documentation goes here"),
                ["return", 2]]],

        [",", 1, 2, ["empty"], 3],
        [",", 1, 2, ["empty"]],
        ["+", 1, ["empty"]],
        ["+", [",", 1, 2, ["empty"], 3]],
        ["+", [",", 1, 2, ["empty"]]],

        ["function", [","],
          ["return"]],

        ["function", [","],
          ["return", ["empty"]]],

        ["function", [","],
          ["return", ["void", 0]]],

        ["function", [","],
          [",", 2,
                ["return", ["void", 0]]]],

        ["function", [","],
          [",", 2,
                [",", 3,
                      ["return", ["void", 0]]]]],

        ["function", [","],
          [",", ["return", ["void", 0]],
                2]],

        ["function", [","],
          ["return", ["void", ["=", a, 0]]]],

        ["function", [","],
          ["throw", ["empty"]]],

        ["function", [","],
          ["return", ["if", 1]]],

        ["function", [","],
          ["return", ["if", 1,
                       ["var", ["=", a, 2]]]]],

        ["function", [","],
          [",", ["return", ["if", 1,
                             ["var", ["=", a, 2]]]],
                3]],

        ["function", [","],
          ["return", ["if", 1,
                       ["var", ["=", a, 2]],
                       ["var", ["=", a, 3]]]]],

        ["function", [","],
          ["return", ["if", 1,
                       ["var", ["=", a, 2]],
                       3]]],

        ["function", [","],
          ["return", ["if", 1,
                       2,
                       ["var", ["=", a, 3]]]]],

        ["function", [","],
          ["return", ["if", 1, 2, 3]]],

        ["function", [","],
          ["return", ["try", 1,
                       ["catch", a]]]],

        ["function", [","],
          [",", ["return", ["try", 1,
                             ["catch", a]]],
                2]],

        ["function", [","],
          ["return", ["try", 1,
                       ["catch", a, 2]]]],

        ["function", [","],
          ["return", ["try", 1,
                       ["catch", a, 2],
                       ["finally", 3]]]],


        ["try", 1, ["catch", a, 2], ["catch", b, 3]],
        ["try", 1, ["finally", 2], ["catch", b, 3]],
        ["try", 1, ["finally", 2], ["finally", 3]],

        ["call", 1, ["...", 2]],
        ["call", 1, ["...", 2], 3],
        ["call", 1, 2, ["...", 3]],
        ["call", 1, 2, ["...", 3], 4],

        ["array", ["...", 2]],
        ["array", ["...", 1], 2],
        ["array", 1, ["...", 2]],
        ["array", 1, ["...", 2], 3],

        ["var", ["=", ["object", NINO.variable("a"), NINO.variable("b")],
                      ["object"]]],

        ["var", ["=", ["object", "a", "b"],
                      ["object"]]],

        ["var", ["=", ["object", ["=", NINO.variable("a"), NINO.variable("b")],
                                 ["=", "foo", NINO.variable("bar")],
                                 ["=", "he^llo", ["array", NINO.variable("yes"), NINO.variable("no")]]],
                      ["object"]]],

        ["var", ["=", ["array", NINO.variable("a"), NINO.variable("b")],
                      ["array", 1, 2]]],

        ["var", ["=", ["array", NINO.variable("a"), ["empty"], NINO.variable("b")],
                      ["array", 1, 2, 3]]],

        ["var", ["=", ["array", NINO.variable("a"), ["...", NINO.variable("b")]],
                      ["array", 1, 2]]],

        ["var", ["=", ["array", NINO.variable("a"),
                                ["...", NINO.variable("b")],
                                NINO.variable("c")],
                      ["array", 1, 2]]],

        ["var", ["=", ["array", NINO.variable("a"),
                                ["...", NINO.variable("b")],
                                NINO.variable("c"),
                                NINO.variable("d")],
                      ["array", 1, 2]]],

        ["var", ["=", ["array", NINO.variable("a"),
                                ["array", NINO.variable("b"), NINO.variable("c")]],
                      ["array", 1, ["array", 2, 3]]]],

        ["=", ["array", NINO.variable("a"), NINO.variable("b")],
              ["array", 1, 2]],

        ["=", ["array", ["array", NINO.variable("a")], NINO.variable("b")],
              ["array", ["array", 1], 2]],

        ["=", ["array", NINO.variable("a"), ["array", NINO.variable("b")]],
              ["array", 1, ["array", 2]]],

        ["function", [",", NINO.variable("a"), ["empty"], NINO.variable("b")]],
        ["function", [",", NINO.variable("a"), ["empty"], ["...", NINO.variable("b")], ["empty"]]],
        ["function", [",", NINO.variable("a"), ["...", NINO.variable("b")]]],
        ["function", [",", NINO.variable("a"), ["...", NINO.variable("b")], NINO.variable("c")]],
        ["function", [",", NINO.variable("a"), ["...", NINO.variable("b")], NINO.variable("c"), NINO.variable("d")]],

        ["function", [",", ["...", NINO.variable("a")]]],

        ["function", [",", ["array", NINO.variable("a"), NINO.variable("b")]]],
        ["function", [",", ["array", NINO.variable("a"), NINO.variable("b")]], 1],

        ["function", [",", NINO.unique(), NINO.unique()],
          ["function", [",", NINO.unique(), NINO.unique()], ["empty"]]],

        (function () {
          var b = NINO.unique()
          return ["function", [",", NINO.unique(), b],
                   ["function", [",", NINO.unique(), NINO.unique()], b]]
        })(),

        (function () {
          var b = NINO.unique()
          return ["function", [",", NINO.unique(), b],
                   ["function", [",", NINO.unique(), NINO.unique(), b], b]]
        })(),

        (function () {
          var b = NINO.unique()
          return ["function", [",", NINO.unique(), b],
                   ["function", [",", NINO.unique(), NINO.unique(), b], ["empty"]]]
        })(),

        (function () {
          var b = NINO.unique()
          return ["function", [",", NINO.unique(), b],
                   ["function", [",", NINO.unique(), NINO.unique()],
                     [",", ["var", ["=", b, 1]],
                           b]]]
        })(),

        (function () {
          var a = NINO.unique("arguments")
          return a
        })(),

        (function () {
          var a = NINO.unique("arguments")
          return [",", a,
                       ["function", [","],
                         a]]
        })(),

        ["+", ["-", 1]],
        ["+", ["+", 1]],
        ["+", 1, ["+", 2]],
        ["+", ["+", 1], ["+", 2]],
        ["+", ["+", 1, 2], ["+", 3, 4]],
        ["+", ["+", ["+", 1], ["+", 2]]],
        ["-", ["+", 1, ["+", 2]]],

        ["function", [","], ["this"]],
        ["function", [","], NINO.variable("this")],

        ["call", 1, 2, ["empty"], 3],

        ["function", [",", NINO.variable("foo"), NINO.variable("bar")],
          NINO.variable("foo")]
      ])

      ;(function () {
        var scope = {}
          , x = NINO.fromJSON([",", 1, 2, 3, ["+", [".", NINO.variable("foo"), "bar"], 4]])
        x = NINO.module([NINO.variable("foo"), "./lib/test"], NINO.variable("exports"), x)
        x = NINO.traverse(x, scope)
        x = NINO.replace(x, scope)
        x = NINO.compile(x)
        console.log(x)
      })()

      parse([
        "var a = 5",
        "var a = function (x) { return 1 + (2 + 3) }; a(20)",
        "var [a, b] = [1, 2]",
        "(function ([a, ...b]) { return b })",
        "var { a } = { a: 1 }",
        "(function (...a, b) { return a })",
        "[1, ...a, 2, 3]",
        "foo(1, ...bar, 2)",
        "{ x, y }",
      ])

      /*expr(["switch", 1,
             ["case", 0, 2],
             ["fallthru", 0, 5],
             ["case", 0, 3],
             ["default", 4]])

      expr(["switch", 1,
             ["case", 0, [",", 2, 3]],
             ["fallthru", 0, 5],
             ["case", 0, [",", 3, 4]],
             ["default", 4]])

      expr(["function", [","],
             ["switch", 1,
               ["case", 0, [",", 2, 3]],
               ["fallthru", 0, 5],
               ["case", 0, [",", 3, 4]],
               ["default", 4]]])*/
    </script>
  </body>
</html>
